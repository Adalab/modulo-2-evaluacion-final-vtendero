"use strict";const inputElement=document.querySelector(".js-input"),searchButtonElement=document.querySelector(".js-searchButton"),searchSeries=document.querySelector(".js-searchList"),searchResults=document.querySelector(".js-searchResults"),formElement=document.querySelector(".js-form"),favResults=document.querySelector(".js-favResults"),favRemove=document.querySelector(".js-favRemoveButton"),reloadResults=document.querySelector(".js-reload");let series=[],favoritesSeries=[];function handleSearchResults(e){e.preventDefault(),getSeries(getSeriesTitle())}function getSeries(e){fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=e,renderSeries(),renderSearchResults()})}function setInLocalStorage(){const e=JSON.stringify(favoritesSeries);localStorage.setItem("favoritesSeries",e)}searchButtonElement.addEventListener("click",handleSearchResults),formElement.addEventListener("submit",handleSearchResults);const getFromLocalStorage=()=>{const e=localStorage.getItem("favoritesSeries");if(null!==e){const s=JSON.parse(e);favoritesSeries=s,renderFavorites()}};function getSeriesTitle(){return inputElement.value}function renderSearchResults(){let e="";e+='<img class="results__search--gif" src="./assets/images/giphy.gif" alt="gif popcorn" title="popcorn gif">',0===series.length?e+='<h2 class="results__search--title">La búsqueda no coincide con ningún resultado.</h2>':e+='<h2 class="results__search--title">Resultados de búsqueda:</h2>',searchResults.innerHTML=e}function renderSeries(){searchResults.classList.remove("js-searchHidden");let e="",s="";for(const t of series)s=isFavorite(t.show.id)?"js-highlighted":"",e+='<li class="results__search--item ">',e+=`<h3 class="results__search--title_movie">${t.show.name}</h3>`,null===t.show.image?e+='<img class="results__search--image" src=https://via.placeholder.com/210x295/ffffff/666666/?text=TV alt="Imagen no disponible">':e+=`<img class="results__search--image" src="${t.show.image.medium}" alt="Imagen serie ${t.show.name}">`,e+=`<div class="results__search--fav js-selected_fav ${s}" id="${t.show.id}" title="Añadir a favoritos">❤︎</div>`,e+="</li>";searchSeries.innerHTML=e,listenClickSeries()}function handleFavoritesSeries(e){addFavoritesSeries(e),renderFavorites(),setInLocalStorage()}function listenClickSeries(){const e=document.querySelectorAll(".js-selected_fav");for(const s of e)s.addEventListener("click",handleFavoritesSeries)}function addFavoritesSeries(e){const s=parseInt(e.currentTarget.id),t=series.find(e=>s===e.show.id),r=favoritesSeries.findIndex(e=>s===e.show.id);-1===r?favoritesSeries.push(t):favoritesSeries.splice(r,1),renderSeries(),renderFavorites()}function isFavorite(e){return-1!==favoritesSeries.findIndex(s=>e===s.show.id)}function renderFavorites(){let e="";for(const s of favoritesSeries)e+='<li class="results__favorites--item">',e+=`<i class="far fa-times-circle results__favorites--delete js-selected_fav" id="${s.show.id}"></i>`,e+=`<h3 class="results__favorites--title_movie">${s.show.name}</h3>`,null===s.show.image?e+='<img class="results__favorites--image" src=https://via.placeholder.com/210x295/ffffff/666666/?text=TValt="Imagen no disponible">':e+=`<img class="results__favorites--image" src="${s.show.image.medium}" alt="Imagen serie ${s.show.name}">`,e+="</li>";favResults.innerHTML=e,listenClickSeries()}function handleRemoveFavorites(){favoritesSeries=[],localStorage.removeItem("favoritesSeries"),renderSeries(),renderFavorites()}function handleReload(){location.reload()}favRemove.addEventListener("click",handleRemoveFavorites),reloadResults.addEventListener("click",handleReload),getFromLocalStorage();